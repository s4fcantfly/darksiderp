<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DS RP - DS Cars</title>
  <link rel="icon" href="assets/logo ds.webp">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    body{background:#09090b;color:#e5e7eb}
    .ds-orange { color: #ea580c; }
    .bg-ds-orange { background-color: #ea580c; }
    .hover\:bg-ds-gold:hover { background-color: #f59e0b; }
    .bg-ds-black { background-color: #09090b; }
    .giant-logo-bg {
      background: #09090b url('assets/logo ds.webp') no-repeat center center;
      background-size: 600px 600px; /* Bigger logo */
      opacity: 1; /* Clear, no transparency */
    }
  </style>
  <!-- Firebase -->
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCaRn2lbQNQjqWUujH_hbomM-9b7JbA9Mk",
    authDomain: "dsrp-ma.firebaseapp.com",
    projectId: "dsrp-ma",
    storageBucket: "dsrp-ma.firebasestorage.app",
    messagingSenderId: "629900395638",
    appId: "1:629900395638:web:15182be43f6c13abea8b57",
    measurementId: "G-CZWJJX4Z43"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Products by category
    const PRODUCTS = {
      SEDAN: [
        { id: "waldw222", name: "waldw222", price: 26, desc: "Luxury sedan with premium features.", image: "assets/cars/waldw222.webp" },
        { id: "w222wald", name: "w222wald", price: 29, desc: "Elegant and powerful sedan.", image: "assets/cars/w222wald.webp" },
        { id: "teslapd", name: "teslapd", price: 25, desc: "Electric sedan with advanced tech.", image: "assets/cars/teslapd.webp" },
        { id: "taycanani", name: "taycanani", price: 29, desc: "Sporty electric sedan.", image: "assets/cars/taycanani.webp" },
        { id: "rs721", name: "rs721", price: 25, desc: "High-performance sedan.", image: "assets/cars/rs721.webp" },
        { id: "rs666", name: "rs666", price: 29, desc: "Aggressive sedan design.", image: "assets/cars/rs666.webp" },
        { id: "rs615", name: "rs615", price: 24, desc: "Compact luxury sedan.", image: "assets/cars/rs615.webp" },
        { id: "rs322sedan", name: "rs322sedan", price: 34, desc: "Reliable family sedan.", image: "assets/cars/rs322sedan.webp" },
        { id: "rs7c8beast", name: "rs7c8beast", price: 27, desc: "Beast-mode sedan upgrade.", image: "assets/cars/rs7c8beast.webp" },
        { id: "rs7bratwa", name: "rs7bratwa", price: 29, desc: "Custom bratwa edition.", image: "assets/cars/rs7bratwa.webp" },
        { id: "rs7", name: "rs7", price: 33, desc: "Top-tier RS7 sedan.", image: "assets/cars/rs7.webp" },
        { id: "rs6rabt20", name: "rs6rabt20", price: 32, desc: "Rabt-tuned RS6.", image: "assets/cars/rs6rabt20.webp" },
        { id: "rs6c8", name: "rs6c8", price: 27, desc: "C8-inspired RS6.", image: "assets/cars/rs6c8.webp" },
        { id: "rrphantom", name: "rrphantom", price: 30, desc: "Phantom Rolls-Royce sedan.", image: "assets/cars/rrphantom.webp" },
        { id: "rmode63s", name: "rmode63s", price: 24, desc: "Rmod E63S sedan.", image: "assets/cars/rmode63s.webp" },
        { id: "mercec63s", name: "mercec63s", price: 33, desc: "Mercedes C63S.", image: "assets/cars/mercec63s.webp" },
        { id: "maybach", name: "maybach", price: 24, desc: "Ultimate Maybach luxury.", image: "assets/cars/maybach.webp" },
        { id: "m4c", name: "m4c", price: 28, desc: "M4 Competition sedan variant.", image: "assets/cars/m4c.webp" },
        { id: "2019m5", name: "2019m5", price: 25, desc: "2019 M5 sedan.", image: "assets/cars/2019m5.webp" },
        { id: "22m5", name: "22m5", price: 33, desc: "2022 M5 upgrade.", image: "assets/cars/22m5.webp" },
        { id: "18rs7", name: "18rs7", price: 29, desc: "2018 RS7.", image: "assets/cars/18rs7.webp" },
        { id: "xc90", name: "xc90", price: 20, desc: "XC90.", image: "assets/cars/xc90.webp" }
      ],
      BIKES: [
        { id: "GODzYAMR1", name: "GODzYAMR1", price: 19, desc: "GODz Yamaha R1.", image: "assets/cars/GODzYAMR1.webp" },
        { id: "GODzNINJAH2", name: "GODzNINJAH2", price: 19, desc: "GODz Ninja H2.", image: "assets/cars/GODzNINJAH2.webp" },
        { id: "GODzBMWS1000RR", name: "GODzBMWS1000RR", price: 19, desc: "GODz BMW S1000RR.", image: "assets/cars/GODzBMWS1000RR.webp" }
      ],
      SUVS: [
        { id: "x6wz", name: "x6wz", price: 24, desc: "X6 WZ SUV.", image: "assets/cars/x6wz.webp" },
        { id: "venatus", name: "venatus", price: 24, desc: "Venatus luxury SUV.", image: "assets/cars/venatus.webp" },
        { id: "rmodx6", name: "rmodx6", price: 24, desc: "Rmod X6.", image: "assets/cars/rmodx6.webp" },
        { id: "rmodr50", name: "rmodr50", price: 17, desc: "Rmod R50 SUV.", image: "assets/cars/rmodr50.webp" },
        { id: "q8prior", name: "q8prior", price: 17, desc: "Q8 Prior edition.", image: "assets/cars/q8prior.webp" },
        { id: "q8hycade", name: "q8hycade", price: 17, desc: "Q8 Hycade.", image: "assets/cars/q8hycade.webp" },
        { id: "mlbrabus", name: "mlbrabus", price: 23, desc: "ML Brabus SUV.", image: "assets/cars/mlbrabus.webp" },
        { id: "mansurus", name: "mansurus", price: 29, desc: "Mansory Urus.", image: "assets/cars/mansurus.webp" },
        { id: "manhartx7", name: "manhartx7", price: 23, desc: "Manhart X7.", image: "assets/cars/manhartx7.webp" },
        { id: "machewb", name: "machewb", price: 15, desc: "Mache WB SUV.", image: "assets/cars/machewb.webp" },
        { id: "KillerHwak", name: "KillerHwak", price: 15, desc: "Killer Hwak.", image: "assets/cars/KillerHwak.webp" },
        { id: "G63Sam", name: "G63Sam", price: 24, desc: "G63 Sam edition.", image: "assets/cars/G63Sam.webp" },
        { id: "fpaceprior", name: "fpaceprior", price: 24, desc: "F-Pace Prior.", image: "assets/cars/fpaceprior.webp" },
        { id: "1016urus", name: "1016urus", price: 29, desc: "1016 Urus.", image: "assets/cars/1016urus.webp" },
        { id: "20xb7", name: "20xb7", price: 24, desc: "20X B7 SUV.", image: "assets/cars/20xb7.webp" },
        { id: "2ncsx7", name: "2ncsx7", price: 17, desc: "2NCS X7.", image: "assets/cars/2ncsx7.webp" }
      ],
      COUPE: [
        { id: "topcargt63", name: "topcargt63", price: 19, desc: "Topcar GT63 coupe.", image: "assets/cars/topcargt63.webp" },
        { id: "s63msc", name: "s63msc", price: 19, desc: "S63 MSC coupe.", image: "assets/cars/s63msc.webp" },
        { id: "s63coupe", name: "s63coupe", price: 19, desc: "S63 Coupe.", image: "assets/cars/s63coupe.webp" },
        { id: "mk4hycade", name: "mk4hycade", price: 22, desc: "Mk4 Hycade.", image: "assets/cars/mk4hycade.webp" },
        { id: "m4f82", name: "m4f82", price: 19, desc: "M4 F82.", image: "assets/cars/m4f82.webp" },
        { id: "m4speedhunter", name: "m4speedhunter", price: 19, desc: "M4 Speedhunter.", image: "assets/cars/m4speedhunter.webp" },
        { id: "golf75r", name: "golf75r", price: 19, desc: "Golf 7 5R.", image: "assets/cars/golf75r.webp" },
        { id: "golf7", name: "golf7", price: 19, desc: "Golf 7 coupe.", image: "assets/cars/golf7.webp" },
        { id: "GODz95GSX", name: "GODz95GSX", price: 22, desc: "GODz 95 GSX.", image: "assets/cars/GODz95GSX.webp" },
        { id: "evox", name: "evox", price: 19, desc: "Evo X coupe.", image: "assets/cars/evox.webp" },
        { id: "crownbp", name: "crownbp", price: 19, desc: "Crown BP.", image: "assets/cars/crownbp.webp" },
        { id: "contgt2011", name: "contgt2011", price: 19, desc: "Continental GT 2011.", image: "assets/cars/contgt2011.webp" },
        { id: "cls19", name: "cls19", price: 19, desc: "CLS 19.", image: "assets/cars/cls19.webp" },
        { id: "civic2020", name: "civic2020", price: 19, desc: "Civic 2020.", image: "assets/cars/civic2020.webp" },
        { id: "a45", name: "a45", price: 22, desc: "A45 AMG.", image: "assets/cars/a45.webp" }
      ],
      "OLD-FASHION": [
        { id: "rmodskyline34", name: "rmodskyline34", price: 25, desc: "Rmod Skyline R34.", image: "assets/cars/rmodskyline34.webp" },
        { id: "rmodm3e36", name: "rmodm3e36", price: 25, desc: "Rmod M3 E36.", image: "assets/cars/rmodm3e36.webp" },
        { id: "rmod240sx", name: "rmod240sx", price: 25, desc: "Rmod 240SX.", image: "assets/cars/rmod240sx.webp" },
        { id: "por911gt3", name: "por911gt3", price: 25, desc: "Porsche 911 GT3.", image: "assets/cars/por911gt3.webp" },
        { id: "m3e36", name: "m3e36", price: 25, desc: "M3 E36 classic.", image: "assets/cars/m3e36.webp" },
        { id: "e55", name: "e55", price: 25, desc: "E55 AMG.", image: "assets/cars/e55.webp" },
        { id: "bmwe39", name: "bmwe39", price: 25, desc: "BMW E39.", image: "assets/cars/bmwe39.webp" },
        { id: "benzc32", name: "benzc32", price: 25, desc: "Benz C32.", image: "assets/cars/benzc32.webp" }
      ],
      "SUPER-CARS": [
        { id: "chironsupersport22", name: "chironsupersport22", price: 39, desc: "Chiron Super Sport 2022.", image: "assets/cars/chironsupersport22.webp" },
        { id: "chironsuper", name: "chironsuper", price: 39, desc: "Chiron Super.", image: "assets/cars/chironsuper.webp" },
        { id: "c63hr", name: "c63hr", price: 39, desc: "C63 HR.", image: "assets/cars/c63hr.webp" },
        { id: "amrevu23mg", name: "amrevu23mg", price: 39, desc: "AMR EV U23 MG.", image: "assets/cars/amrevu23mg.webp" },
        { id: "c8", name: "c8", price: 49, desc: "Corvette C8.", image: "assets/cars/c8.webp" },
        { id: "AmgGtrLight", name: "AmgGtrLight", price: 39, desc: "AMG GTR Light.", image: "assets/cars/AmgGtrLight.webp" },
        { id: "amggtbs", name: "amggtbs", price: 39, desc: "AMG GT BS.", image: "assets/cars/amggtbs.webp" },
        { id: "1016rwdevo", name: "1016rwdevo", price: 34, desc: "1016 RWD Evo.", image: "assets/cars/1016rwdevo.webp" },
        { id: "911turbos", name: "911turbos", price: 34, desc: "911 Turbos.", image: "assets/cars/911turbos.webp" },
        { id: "911gtrs", name: "911gtrs", price: 34, desc: "911 GTRS.", image: "assets/cars/911gtrs.webp" },
        { id: "488animated", name: "488animated", price: 34, desc: "488 Animated.", image: "assets/cars/488animated.webp" },
        { id: "488", name: "488", price: 34, desc: "Ferrari 488.", image: "assets/cars/488.webp" },
        { id: "17mansorypnmr", name: "17mansorypnmr", price: 34, desc: "2017 Mansory Panorama.", image: "assets/cars/17mansorypnmr.webp" },
        { id: "2ncsbmwm8", name: "2ncsbmwm8", price: 34, desc: "2NCS BMW M8.", image: "assets/cars/2ncsbmwm8.webp" },
        { id: "488sp", name: "488sp", price: 39, desc: "488 Spider.", image: "assets/cars/488sp.webp" }
      ]
    };

    let currentCategory = 'SEDAN'; // Default category
    let selectedProduct = null; // To hold the currently selected product

    function setCategory(category) {
      currentCategory = category;
      renderProducts();
      updateTabStyles();
    }

    function updateTabStyles() {
      const tabs = document.querySelectorAll('#categoryTabs button');
      tabs.forEach(tab => {
        const cat = tab.onclick.toString().match(/'([^']+)'/)[1];
        if (cat === currentCategory) {
          tab.className = 'px-4 py-2 bg-ds-orange text-black font-bold rounded hover:bg-ds-gold transition shadow-lg glow';
        } else {
          tab.className = 'px-4 py-2 bg-white/10 text-gray-200 rounded hover:bg-ds-orange hover:text-black transition shadow-md';
        }
      });
    }

    function renderProducts() {
      const container = document.getElementById('products');
      container.innerHTML = '';
      const categoryProducts = PRODUCTS[currentCategory] || [];
      categoryProducts.forEach(p => {
        const card = document.createElement('div');
        card.className = "bg-[#0f1720] p-4 rounded-lg border border-white/5 flex flex-col hover:shadow-2xl hover:shadow-ds-orange/20 transition-all duration-300 hover:scale-105";
        card.innerHTML = `
          <img src="${p.image}" alt="${p.name}" class="h-40 object-cover w-full mb-3 bg-black/40 rounded hover:opacity-80 transition">
          <div class="flex-1">
            <h3 class="font-bold text-lg">${p.name}</h3>
            <p class="text-gray-400 text-sm mb-3">${p.desc}</p>
          </div>
          <div class="flex items-center justify-between mt-3">
            <div class="text-ds-orange font-bold">$${p.price.toFixed(2)}</div>
            <div class="flex gap-2">
              <button onclick="showDetails('${p.id}')" class="px-3 py-1 text-sm bg-white/5 rounded">Details</button>
              <button onclick="orderCar('${p.id}')" class="px-3 py-1 bg-ds-orange text-black font-bold rounded hover:bg-ds-gold transition shadow-md hover:shadow-lg">Order</button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
      lucide.createIcons();
    }

  function showDetails(id) {
    const p = Object.values(PRODUCTS).flat().find(x => x.id === id);
    alert(`${p.name}\n\n${p.desc}\n\nPrice: $${p.price.toFixed(2)}\n\nTo order, enter your Discord ID below.`);
  }

  function orderCar(productId) {
    // Find the product from any category
    selectedProduct = Object.values(PRODUCTS).flat().find(p => p.id === productId);
    if (!selectedProduct) return;

    // Populate and show the form
    document.getElementById('orderProductName').textContent = selectedProduct.name;
    const orderForm = document.getElementById('orderForm');
    document.getElementById('orderForm').classList.remove('hidden');
    document.getElementById('discordId').focus();
    orderForm.scrollIntoView({ behavior: 'smooth' });
  }

  async function submitOrder() {
    const discordId = document.getElementById('discordId').value.trim();
    if (!discordId || !selectedProduct) return alert('Please enter a valid Discord ID.');

    const submitBtn = document.getElementById('submitOrderBtn');
    submitBtn.disabled = true;
    submitBtn.textContent = 'Submitting...';

    try {
      // Save to Firebase
      await addDoc(collection(db, 'carOrders'), {
        productId: selectedProduct.id,
        productName: selectedProduct.name,
        discordId,
        timestamp: serverTimestamp(),
        status: 'pending'
      });

      // Post to Discord webhook
      const webhookUrl = 'https://discord.com/api/webhooks/1449917248465670236/igF5ckp16pJWCjFtMXyMDv2UzINh2MeEKS89HWkYHBBtERpU9f-CufTtCJYlGl3E8peM';
      const webhookResponse = await fetch(webhookUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          content: `New car order: **${selectedProduct.name}** for Discord ID: **${discordId}**. Price: $${selectedProduct.price.toFixed(2)}. Check Firebase for details.`
        })
      });
      
      if (!webhookResponse.ok) {
        // If the webhook returns an error (e.g., 404 Not Found), throw an error to be caught below.
        const errorData = await webhookResponse.json();
        throw new Error(`Discord webhook failed: ${errorData.message}`);
      }
      
      alert('Order submitted! Mods will contact you on Discord for delivery.');
      document.getElementById('orderForm').classList.add('hidden');
      document.getElementById('discordId').value = '';
    } catch (err) {
      console.error(err);
      alert('Order failed. Try again or contact mods on Discord.');
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = 'Submit Order';
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    // Attach event listener
    document.getElementById('submitOrderBtn').addEventListener('click', submitOrder);

    // Expose functions globally for HTML onclick
    window.showDetails = showDetails;
    window.orderCar = orderCar;
    window.setCategory = setCategory;

    renderProducts();
    updateTabStyles(); // Initial call
  });
</script>
</head>
<body class="min-h-screen p-6">
  <header class="flex items-center justify-between mb-8">
    <div class="flex items-center gap-3">
      <img src="assets/logo ds.webp" class="h-10 w-10" alt="DS">
      <h1 class="text-2xl font-bold">DS RP â€” VIP Cars</h1>
    </div>
    <nav class="flex gap-4">
      <a href="index.html" class="text-base hover:text-ds-orange">Home</a>
      <a href="vip.html" class="text-base font-bold">Shop</a>
      <a href="https://discord.gg/TPPGVZA4zF" target="_blank" class="text-base hover:text-ds-orange">Discord</a>
    </nav>
  </header>

  <main class="giant-logo-bg p-6 min-h-screen">
    <p class="text-gray-400 mb-6 max-w-2xl">Browse premium VIP vehicles. Submit an order with your Discord ID for mod review.</p>

    <!-- Category Tabs -->
    <div class="flex flex-wrap gap-2 mb-6" id="categoryTabs">
      <button onclick="setCategory('SEDAN')" class="px-4 py-2 bg-ds-orange text-black font-bold rounded hover:bg-ds-gold transition shadow-lg">SEDAN</button>
      <button onclick="setCategory('BIKES')" class="px-4 py-2 bg-white/10 text-gray-200 rounded hover:bg-ds-orange hover:text-black transition shadow-md">BIKES</button>
      <button onclick="setCategory('SUVS')" class="px-4 py-2 bg-white/10 text-gray-200 rounded hover:bg-ds-orange hover:text-black transition shadow-md">SUV'S</button>
      <button onclick="setCategory('COUPE')" class="px-4 py-2 bg-white/10 text-gray-200 rounded hover:bg-ds-orange hover:text-black transition shadow-md">COUPE</button>
      <button onclick="setCategory('OLD-FASHION')" class="px-4 py-2 bg-white/10 text-gray-200 rounded hover:bg-ds-orange hover:text-black transition shadow-md">OLD-FASHION</button>
      <button onclick="setCategory('SUPER-CARS')" class="px-4 py-2 bg-white/10 text-gray-200 rounded hover:bg-ds-orange hover:text-black transition shadow-md">SUPER-CARS</button>
    </div>

    <div id="products" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>

    <div id="orderForm" class="hidden mt-6 p-4 bg-[#0f1720] rounded-lg border border-white/5">
      <h3 class="font-bold mb-3">Order <span id="orderProductName"></span></h3>
      <label class="block text-sm text-gray-400 mb-2">Your Discord ID (e.g., username#1234)</label>
      <input id="discordId" type="text" class="w-full p-3 rounded bg-black/40 border border-white/5 mb-3" placeholder="Enter your Discord ID" />
      <button id="submitOrderBtn" class="w-full bg-ds-orange text-black font-bold py-2 rounded">Submit Order</button>
      <p class="text-xs text-gray-400 mt-2">Mods will review and deliver the vehicle in-game.</p>
    </div>
  </main>
</body>
</html>